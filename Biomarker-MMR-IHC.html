<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MMR IHC test</title>
<link rel="stylesheet" type="text/css" href="view.css" media="all">
<script type="text/javascript" src="view.js"></script>
<script>
function updateDescription (frm) 
{
    var Template = ""

if (frm.MLH1.value !== ""){
Template += "- MLH1 (mutL homolog 1): " + frm.MLH1.value + "\n";
}

if (frm.MSH2.value !== ""){
Template += "- MSH2 (mutS homolog 2): "+ frm.MSH2.value + "\n";
}

if (frm.MSH6.value !== ""){
Template += "- MSH6 (mutS homolog 6): " + frm.MSH6.value + "\n";
}

if (frm.PMS2.value !== ""){
Template += "- PMS2 (PMS1 homolog 2): " + frm.PMS2.value + "\n";
}

if (frm.IHC.value !== ""){
Template += "\n" + "- IHC Interpretation for tumor: " +  "\n" + "  - " + frm.IHC.value + "\n"+ "\n";
}

if (frm.BAT25.value + frm.BAT26.value + frm.NR21.value + frm.NR24.value + frm.NR27.value!== ""){
	Template += "\n" + "- Mononucleotide Panel: " + "\n";
}	

if (frm.BAT25.value !== ""){
	Template += "  - BAT-25 : " + frm.BAT25.value + "\n";
}

if (frm.BAT26.value !== ""){
	Template += "  - BAT-26 : " + frm.BAT26.value + "\n";
}

if (frm.NR21.value !== ""){
	Template += "  - NR-21 : " + frm.NR21.value + "\n";
}

if (frm.NR24.value !== ""){
	Template += "  - NR-24 : " + frm.NR24.value + "\n";
}

if (frm.NR27.value !== ""){
	Template += "  - NR-27 : " + frm.NR27.value + "\n";
}

if (frm.BAT251.value + frm.BAT261.value + frm.D2.value + frm.D5.value + frm.D17.value!== ""){
	Template += "\n" + "- NCI Panel: " + "\n";
}	

if (frm.BAT251.value !== ""){
	Template += "  - BAT-25 : " + frm.BAT251.value + "\n";
}

if (frm.BAT261.value !== ""){
	Template += "  - BAT-26 : " + frm.BAT261.value + "\n";
}

if (frm.D2.value !== ""){
	Template += "  - D2S123 : " + frm.D2.value + "\n";
}

if (frm.D5.value !== ""){
	Template += "  - D5S346 : " + frm.D5.value + "\n";
}

if (frm.D17.value !== ""){
	Template += "  - D17S250 : " + frm.D17.value + "\n";
}

if (frm.MSI.value !== ""){
Template += "\n" + "- Microsatellite instability status: " + "\n" + "  - " + frm.MSI.value + "\n";
}

if (frm.MSI.value !== ""){
	Template += "\n" + "DNA was extracted from the tumor tissue and the normal tissue, following microdissection of formalin-fixed paraffin-embedded tissue sections. MSI was assessed using a laboratory developed method by comparing the differences in patterns of PCR products of 5 mononucleotide repeats and 3 dinucleotide repeats markers of the tumor tissue and those of the normal tissue. " + "\n" + "\n" + "The MSI test is under evaluation and is not in the CAP-acredited list.";
}

frm.holdtext.value = Template;
}

function CopyToClipboard() {
  /* Get the text field */
  var copyText = document.getElementById("holdtext");

  /* Select the text field */
  copyText.select();

  /* Copy the text inside the text field */
  document.execCommand("copy");

  /* Alert the copied text */
  alert("Report copied to clipboard");
}
</script>
<style>
table, th, td {
  border: 1px solid silver;
  border-collapse: collapse;
  padding: 4px;
}
</style>
</head>

<body>
<img id="top" src="top.png" alt="">
	<div id="form_container">
	<div class="form_description">
		<h2><a href=".\cap\Cancer-Protocols-2021-06-Update\General-Protocol-Folder\DNA.MMR.Bmk_1.0.0.2.REL_CAPCP.pdf" target="_blank">
		<div class="tooltip">DNA MMR IHC test / MSI test
		<span class="tooltiptext">click to access explanations in the original CAP template</span>
		</div>
		</a></h2>
	</div>
	- there are different references for    
		<a href=".\cap\Cancer-Protocols-2021-06-Update\Gastrointestinal-Protocol-Folder\ColoRectal.Bmk_1.3.0.0.REL_CAPCP.pdf#page=11" target="_blank">
		<div class="tooltip">colorectal cancers
		<span class="tooltiptext">click to access the original CAP template</span>
		</div>
		</a>
	and
		<a href=".\cap\Cancer-Protocols-2021-06-Update\Gynecologic-Protocol-Folder\cp-femalereproductive-endometrium-biomarker-19-1201#page=9" target="_blank">
		<div class="tooltip">endometrial cancers.
		<span class="tooltiptext">click to access the original CAP template</span>
		</div>
		</a>
	<br>
    - <a href=".\cap\1-s2.0-S1756231720300402-main.pdf#page=18" target="_blank">Pitfalls</a> in interpretations in gynecological tumors.
<br>
<br>

<form>
<fieldset style="border-color:#e6e6ff;">
	<legend><label class="description">Immunohistochemical staining:</label></legend>
<p>
<table border="1">
<col width="40%">

<tr>
<td >
<label class="description">- MLH1 (mutL homolog 1):</label></td >
<td ><select class="element select large"  ID="MLH1">
	<option value=""></option>
	<option value="Intact nuclear expression in tumor cells">Intact nuclear expression in tumor cells</option>
	<option value="Loss of nuclear expression in tumor cells">Loss of nuclear expression in tumor cells</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
</select></td >
</tr>

<tr>
<td ><label class="description">- MSH2 (mutS homolog 2):</label></td >
<td ><select class="element select large"  ID="MSH2">
	<option value=""></option>
	<option value="Intact nuclear expression in tumor cells">Intact nuclear expression in tumor cells</option>
	<option value="Loss of nuclear expression in tumor cells">Loss of nuclear expression in tumor cells</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
</select></td >
</tr>

<tr>
<td ><label class="description">- MSH6 (mutS homolog 6):</label></td >
<td ><select class="element select large"  ID="MSH6">
	<option value=""></option>
	<option value="Intact nuclear expression in tumor cells">Intact nuclear expression in tumor cells</option>
	<option value="Loss of nuclear expression in tumor cells">Loss of nuclear expression in tumor cells</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
</select></td >
</tr>

<tr>
<td ><label class="description">- PMS2 (PMS1 homolog 2):</label></td >
<td ><select class="element select large"  ID="PMS2">
	<option value=""></option>
	<option value="Intact nuclear expression in tumor cells">Intact nuclear expression in tumor cells</option>
	<option value="Loss of nuclear expression in tumor cells">Loss of nuclear expression in tumor cells</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
</select></td >
</tr>
</table>
</p>

<p><label class="description">- MMR IHC Interpretation for the tumor:</label>
<select class="element select medium"  ID="IHC">
	<option value=""></option>
	<option value="No loss of nuclear signals of all 4 proteins: Not defective in DNA mismatch repair (non-dMMR or MMRp) and low probability of microsatellite instability-high (MSI-H).">No loss of nuclear signals of all 4 proteins: Not defective in DNA mismatch repair (non-dMMR or MMRp) and low probability of microsatellite instability-high (MSI-H).</option>
	<option value="Loss of nuclear signals of 1 or more proteins: Defective DNA mismatch repair within the tumor (dMMR). Causes could be somatic mutation or DNA methylation (sporadic), or germline alteration (Lynch syndrome).">Loss of nuclear signals of 1 or more proteins: Defective DNA mismatch repair within the tumor (dMMR). </option>
	<option value="MMR status cannot be determined by IHC.">MMR status cannot be determined by IHC.</option>
</select>
</p>
</fieldset>
</p>
<p>
<fieldset style="border-color:#e6e6ff;">
	<legend><label class="description">DNA-based PCR test for Microsatellite instability (MSI):</label></legend>

<p>
<table border="1">
<col width="15%">
<tr>
<td colspan="2">
<label class="description" align="Center">Mononucleotide Panel :</label>
</td>
<td colspan="2">
<label class="description" align="Center">NCI Panel :</label>
</td>
</tr>

<tr>
<td >
<label class="description">BAT-25:</label></td >
<td ><select class="element select large"  ID="BAT25">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
<td >
<label class="description">BAT-25:</label></td >
<td ><select class="element select large"  ID="BAT251">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
</tr>

<tr>
<td >
<label class="description">BAT-26:</label></td >
<td ><select class="element select large"  ID="BAT26">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
<td >
<label class="description">BAT-26:</label></td >
<td ><select class="element select large"  ID="BAT261">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
</tr>

<tr>
<td >
<label class="description">NR-21 :</label></td >
<td ><select class="element select large"  ID="NR21">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
<td >
<label class="description">D2S123:</label></td >
<td ><select class="element select large"  ID="D2">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
</tr>

<tr>
<td >
<label class="description">NR-24 :</label></td >
<td ><select class="element select large"  ID="NR24">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
<td >
<label class="description">D5S346:</label></td >
<td ><select class="element select large"  ID="D5">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
</tr>

<tr>
<td >
<label class="description">NR-27 :</label></td >
<td ><select class="element select large"  ID="NR27">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
<td >
<label class="description">D17S250:</label></td >
<td ><select class="element select large"  ID="D17">
	<option value=""></option>
	<option value="Stable">Stable</option>
	<option value="Unstable">Unstable</option>
	<option value="Cannot be determined:">Cannot be determined:</option>
	<option value="Not performed">Not performed</option>
</select>
</td >
</tr>
</table>
</p>

<p><label class="description">- MSI status:</label>
<select class="element select medium"  ID="MSI">
	<option value=""></option>
	<option value="MSI - stable (MSS)">MSI – stable (MSS)</option>
	<option value="MSI - low (MSI-L) 1% - 29% of the National Cancer Institute (NCI) or mononucleotide markers exhibit instability">MSI – low (MSI-L) 1% - 29% of the National Cancer Institute (NCI) or mononucleotide markers exhibit instability</option>
	<option value="MSI - low (MSI-L) 1 of the NCI or mononucleotide markers exhibit instability">MSI – low (MSI-L) 1 of the NCI or mononucleotide markers exhibit instability</option>
	<option value="MSI - low (MSI-L) Other (specify): ">MSI – low (MSI-L) Other (specify):</option>
	<option value="MSI - high (MSI-H) greater or equal 30% of the NCI or mononucleotide markers exhibit instability">MSI – high (MSI-H) greater or equal 30% of the NCI or mononucleotide markers exhibit instability</option>
	<option value="MSI - high (MSI-H) 2 or more of the NCI or mononucleotide markers exhibit instability">MSI – high (MSI-H) 2 or more of the NCI or mononucleotide markers exhibit instability</option>
	<option value="MSI - high (MSI-H) Other (specify): ">MSI – high (MSI-H) Other (specify):</option>
	<option value="MSI - cannot be determined.">MSI - cannot be determined.</option>
</select>

<br>
</fieldset>
</p>


<br><br>
<input type="button" name="copyform" value="Check your Report" onclick="updateDescription(this.form)"/>
<br>
<TEXTAREA ID="holdtext" name="holdtext" class="textarea large" style="border-color:coral;"></TEXTAREA>

<br><br>
<!-- The button used to copy the text -->
<button onclick="CopyToClipboard()">Copy text to Clipboard</button>

<input type="reset" value="Reset Form" name="reset" style="float: right;">
</form>
<br>
<br>

<div id="footer">
Last upated 11-Jul-2021,<br>
modified from <a href="https://www.cap.org/protocols-and-guidelines/cancer-reporting-tools/cancer-protocol-templates" target="_blank">US CAP cancer protocol templates</a>.<br>
html form and cascade style sheet were created basing on <a href="http://www.phpform.org">pForm</a>,<br>
with codes modified from <a href="https://www.w3schools.com/">W3 School tutorials</a> and <a href="https://stackoverflow.com/">Stack Overflow</a>.<br><br>
Anatomical Pathology Division, Queen Mary Hospital, Hong Kong.</div>
</div>
</div>
<img id="bottom" src="bottom.png" alt="">
</body>
</html>

